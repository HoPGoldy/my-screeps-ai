# 战争模块（待实现）

整体设计：全局存在一个战争模块，战争模块可以新增和管理多个战争进程，每个战争进程可以新增和管理多个小队进程（位于 `./squad`）。

**战争进程和小队进程的区别**：

一场战争可以有多个进攻目标，每个目标都由一个小队负责。

一个小队进程控制一个小队，内部就是纯粹的控制 creep 进攻目标旗帜。当小队成员阵亡时战斗进程将结束并提交至战争进程。

战争进程负责全局管理，例如 creep 孵化、boost。在孵化完成后会拿着准备就绪的单位启动小队进程。当小队成员阵亡时，将接管小队剩余成员的动作，并尝试建立新的小队。

## 战争状态

战争进程有如下几个状态：

- 进行中：【默认状态】各个小队正常按照路径点进攻
- 胜利：【有小队抵达战争目标旗帜】各个小队自由挑选目标，不再继续孵化
- 终止：【无法继续进行战争时（如 boost 不足，主动执行 `war.stop`）】各个小队继续进攻路径点，但不再进行继续孵化
- 结束：【胜利状态、终止状态下的小队单位全部死掉时】没有主动行为，仅可以查看战争总结。

当战争结束后，可以通过 `war.close` 关闭战争，关闭后将无法查看战争总结，战争在其他状态时也可以通过 `war.close` 强制结束战争，将会直接清除掉所有小队单位。

## api 设计

### start 启动战争

接收参数：来源房间名、目标旗帜名

### default 配置默认小队

接收参数：小队类型，是否 boost，目标旗帜代号（可选）

### stop 终止战争

将战争切换至终止状态

### resume 继续战争

将战争从终止、胜利状态切换为进行状态

### close 关闭战争

关闭战争，将会主动移除所有单位，对应战争进程将被关闭无法访问

### 新增小队

接收参数：小队类型，是否 boost，目标旗帜代号（可选）

## 路径点

一个路径点就是一个旗帜，一条路径就是代号 + 编号，例如 battleA0、battleA1、battleA2，代号为 battleA 的小队将从 0 号旗帜开始，按照顺序一直向下一个路径点进攻。一条路径最多放置 10 个路径点。

与路径点有关的行为：

- 新建小队时，如果没有指定目标旗帜名，将会根据战争的目标旗帜名和位置生成 0 号路径点
- 当小队抵达目标路径点、且没有后续路径点时，目标路径点将被更新为战争旗帜所在位置
- 当小队抵达目标路径点后，如果目标路径点和战争旗帜位置重合，将被判定为战争胜利